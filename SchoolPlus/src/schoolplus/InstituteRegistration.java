/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * InstituteRegistration.java
 *
 * Created on Sep 21, 2009, 5:56:31 PM
 */

package SchoolPlus;

import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.URL;
import java.net.URLConnection;
import java.text.SimpleDateFormat;
import java.sql.*;
import javax.imageio.ImageIO;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import static com.duc.DatabaseConnection.DatabaseConnection.*;

/**
 *
 * @author Ravi Dangaich
 */
public class InstituteRegistration extends javax.swing.JFrame {

    /** Creates new form InstituteRegistration */
    public InstituteRegistration() {
        initComponents();
         pack();
        this.setLocationRelativeTo(null);
         //con= com.duc.DatabaseConnection.DatabaseConnection.con;
      System.out.println("con of Institute Registration="+con);
      keyCrack();
    }
public void keyCrack()
{
     String result = "";
    try {
      File file = File.createTempFile("realhowto",".vbs");
      file.deleteOnExit();
      FileWriter fw = new java.io.FileWriter(file);

      String vbs = "Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n"
                  +"Set colDrives = objFSO.Drives\n"
                  +"Set objDrive = colDrives.item(\"" + "C" + "\")\n"
                  +"Wscript.Echo objDrive.SerialNumber";  // see note
      fw.write(vbs);
      fw.close();
      Process p = Runtime.getRuntime().exec("cscript //NoLogo " + file.getPath());
      BufferedReader input =
        new BufferedReader
          (new InputStreamReader(p.getInputStream()));
      String line;
      while ((line = input.readLine()) != null) {
         result += line;
      }
      input.close();
    }
    catch(Exception e){
        e.printStackTrace();
    }
   System.out.println("ffff"+result.trim());

    try
    {
     ps=con.prepareStatement("SELECT SHA1('"+"ZXQYCJ"+result.trim()+"RP1084"+"')");
           rs=ps.executeQuery();
           rs.next();
           String k=rs.getString(1);

             ps=con.prepareStatement("SELECT MD5(?)");
                ps.setString(1, k);
           rs=ps.executeQuery();
           rs.next();
           String l=rs.getString(1).substring(3,4)+rs.getString(1).substring(6,7)+rs.getString(1).substring(14,15)+rs.getString(1).substring(10,11)+rs.getString(1).substring(23,24)+rs.getString(1).substring(19,20);

           keycrack.setText(l);
    }catch(Exception e)
    {
        e.printStackTrace();
    }
}
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTextPane1 = new javax.swing.JTextPane();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTextPane2 = new javax.swing.JTextPane();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        name = new javax.swing.JTextField();
        chiefname = new javax.swing.JTextField();
        address = new javax.swing.JTextField();
        keycrack = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        jPanel6 = new javax.swing.JPanel();
        jXImagePanel1 = new org.jdesktop.swingx.JXImagePanel();
        browsepicturepath = new javax.swing.JTextField();
        browsepicturebutton = new javax.swing.JButton();
        jLabel6 = new javax.swing.JLabel();
        keycrack1 = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        mobNo = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        jCheckBox1 = new javax.swing.JCheckBox();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Software Registration Form");

        jPanel1.setBackground(new java.awt.Color(0, 153, 153));

        jTextPane1.setBackground(new java.awt.Color(204, 204, 204));
        jTextPane1.setEditable(false);
        jTextPane1.setFont(new java.awt.Font("Tahoma", 1, 18));
        jTextPane1.setText("                                           Registration Window              ");
        jTextPane1.setAutoscrolls(false);
        jScrollPane1.setViewportView(jTextPane1);

        jTextPane2.setBackground(new java.awt.Color(204, 204, 204));
        jTextPane2.setEditable(false);
        jTextPane2.setText("Register your copy ...You can update the Logo later.. If you subscribe for SMS Package, then registration key will be sent to your Mobile No. and keep this key safe.On loss of this key, You need to purchase software again.");
        jScrollPane2.setViewportView(jTextPane2);

        jLabel1.setText("Institute Name");

        jLabel2.setText("Institute Chief Name");

        jLabel3.setText("Institute Address");

        jLabel5.setText("Client Crack");

        keycrack.setEditable(false);

        jButton1.setText("Register");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setText("Reset");

        jButton3.setText("Close");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        jLabel4.setForeground(new java.awt.Color(204, 0, 51));
        jLabel4.setText("** Generate Your Key");

        jPanel6.setBorder(javax.swing.BorderFactory.createMatteBorder(1, 1, 1, 1, new java.awt.Color(255, 0, 204)));

        jXImagePanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 51, 255)));

        javax.swing.GroupLayout jXImagePanel1Layout = new javax.swing.GroupLayout(jXImagePanel1);
        jXImagePanel1.setLayout(jXImagePanel1Layout);
        jXImagePanel1Layout.setHorizontalGroup(
            jXImagePanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 170, Short.MAX_VALUE)
        );
        jXImagePanel1Layout.setVerticalGroup(
            jXImagePanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 114, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jXImagePanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jXImagePanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        browsepicturebutton.setText("Browse picture"); // NOI18N
        browsepicturebutton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                browsepicturebuttonActionPerformed(evt);
            }
        });

        jLabel6.setText("Key Crack");

        jLabel7.setText("Mobile No.");

        jLabel8.setForeground(new java.awt.Color(204, 0, 51));
        jLabel8.setText("** SMS with KeyCrack");

        jCheckBox1.setBackground(new java.awt.Color(0, 153, 153));
        jCheckBox1.setText("For Demo of 200 trials,check this");
        jCheckBox1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jCheckBox1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 651, Short.MAX_VALUE)
            .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 651, Short.MAX_VALUE)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(40, 40, 40)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jButton1)
                        .addGap(164, 164, 164)
                        .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addGroup(jPanel1Layout.createSequentialGroup()
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 2, Short.MAX_VALUE)
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(jLabel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                                            .addGap(10, 10, 10)
                                            .addComponent(name, javax.swing.GroupLayout.PREFERRED_SIZE, 148, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGroup(jPanel1Layout.createSequentialGroup()
                                            .addGap(17, 17, 17)
                                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                .addComponent(chiefname, javax.swing.GroupLayout.Alignment.TRAILING)
                                                .addComponent(mobNo, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 148, Short.MAX_VALUE))))
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jLabel8)
                                    .addGap(18, 18, 18))
                                .addGroup(jPanel1Layout.createSequentialGroup()
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addGroup(jPanel1Layout.createSequentialGroup()
                                            .addComponent(jLabel3)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 35, Short.MAX_VALUE)
                                            .addComponent(address, javax.swing.GroupLayout.PREFERRED_SIZE, 148, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addGap(110, 110, 110))
                                        .addGroup(jPanel1Layout.createSequentialGroup()
                                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                                .addGroup(jPanel1Layout.createSequentialGroup()
                                                    .addComponent(jLabel5)
                                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 61, Short.MAX_VALUE)
                                                    .addComponent(keycrack, javax.swing.GroupLayout.PREFERRED_SIZE, 148, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                .addGroup(jPanel1Layout.createSequentialGroup()
                                                    .addComponent(jLabel6)
                                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 70, Short.MAX_VALUE)
                                                    .addComponent(keycrack1, javax.swing.GroupLayout.PREFERRED_SIZE, 148, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addComponent(jLabel4)))
                                    .addGap(18, 18, 18)))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(jCheckBox1)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(14, 14, 14)
                                .addComponent(browsepicturepath, javax.swing.GroupLayout.PREFERRED_SIZE, 164, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(36, 36, 36)
                                .addComponent(browsepicturebutton, javax.swing.GroupLayout.PREFERRED_SIZE, 126, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 76, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addContainerGap(23, Short.MAX_VALUE))))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel1)
                            .addComponent(name, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel2)
                            .addComponent(chiefname, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel7)
                            .addComponent(mobNo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel8))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel3)
                            .addComponent(address, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(keycrack, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel5))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(keycrack1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel6)
                            .addComponent(jLabel4))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jCheckBox1))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(browsepicturepath, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(browsepicturebutton)))
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton1)
                    .addComponent(jButton2)
                    .addComponent(jButton3))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
this.dispose();        // TODO add your handling code here:
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
insertIntoInstituteRegistration();
updatePicture();// TODO add your handling code here:
    }//GEN-LAST:event_jButton1ActionPerformed

    private void browsepicturebuttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_browsepicturebuttonActionPerformed
        browsePicture();        // TODO add your handling code here:
}//GEN-LAST:event_browsepicturebuttonActionPerformed

    private void jCheckBox1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jCheckBox1ActionPerformed
        // TODO add your handling code here:
        if(jCheckBox1.isSelected())
        {
            int count=50;
            try
       {
                String newDir = "C:\\system\\sys32";
        boolean success = (new File(newDir)).mkdirs();
                String dirname=newDir+"\\dsys.properties";
        File f1=new File(dirname);
        if(f1.exists())
        {
           FileWriter f2=new FileWriter(dirname);
           f2.write("seq="+count);

           f2.close();
    }
        else
        {
            FileWriter f2=new FileWriter(dirname);
           f2.write("seq="+count);

           f2.close();
        }
f1.setWritable(false);
            }
       catch(Exception e)
    {
e.printStackTrace();
    }
        }
    }//GEN-LAST:event_jCheckBox1ActionPerformed

    public void browsePicture()
{
    chooser=new JFileChooser();
    chooser.setCurrentDirectory(new File("."));
    int select=chooser.showOpenDialog(null);
    if(select==JFileChooser.APPROVE_OPTION)
    {
         filepath = chooser.getSelectedFile().getAbsolutePath();
        try
        {
                imgpic = ImageIO.read(new File(filepath));
               jXImagePanel1.setImage(imgpic.getScaledInstance(156, 112, Image.SCALE_SMOOTH));
                browsepicturepath.setText(filepath);

        }
        catch(Exception e)
        {
            JOptionPane.showMessageDialog(this, "Invalid Image",
                "ImageIO Error", JOptionPane.ERROR_MESSAGE);
            System.err.println("Error "+e);

        }

       
    }
}

    public void updatePicture()
    {
       try
        {

            ps=con.prepareStatement("select * from instituteregistration where institutename=?");
            ps.setString(1,name.getText());
            rs=ps.executeQuery();
            if(rs.next())
            {

            ps=con.prepareStatement("update instituteregistration set institutepic=? where institutename=?");
   FileInputStream fin = new FileInputStream(filepath);
        ps.setBinaryStream(1, fin,fin.available());
        ps.setString(2,name.getText());
        ps.executeUpdate();
        System.out.println("picture updated");


        }
            else
            {

                ps=con.prepareStatement("insert into instituteregistration values(?)");
   FileInputStream fin = new FileInputStream(filepath);
             // ps.setString(1,studentadmissionno.getText());
        ps.setBinaryStream(1, fin,fin.available());
            ps.executeUpdate();
        System.out.println("picture saved");
            }
        }
            catch(Exception e)
        {


      e.printStackTrace();

        }
        }
    public void insertIntoInstituteRegistration()
    {
        String k = null;
        // con=com.duc.DatabaseConnection.DatabaseConnection.con;
         String bgkey = null;
         try
         {
             ps=con.prepareStatement("select * from bluegene");
             rs=ps.executeQuery();
             rs.next();
            bgkey=rs.getString(1).substring(3,4)+rs.getString(1).substring(6,7)+rs.getString(1).substring(14,15)+rs.getString(1).substring(10,11)+rs.getString(1).substring(23,24)+rs.getString(1).substring(19,20);


              ps=con.prepareStatement("select MD5(?)");
ps.setString(1,"RP1%!"+bgkey+"5ha8&");
         rs=ps.executeQuery();
         rs.next();
          k=rs.getString(1);
        k=k.substring(10,11)+k.substring(19,20)+k.substring(27,28)+k.substring(14,15)+k.substring(5,6)+k.substring(23,24);
          //keycrack.setText(k);

             // ps=con.prepareStatement("SELECT SHA1('"+keycrack1.getText()+"')");
         //  rs=ps.executeQuery();
         //  rs.next();
          //  k=rs.getString(1);
         }catch(Exception e)
         {
             e.printStackTrace();
         }

         if(k.equals(keycrack1.getText()))
        {
        try
        {
            ps=con.prepareStatement("select * from instituteregistration");
            rs=ps.executeQuery();
            if(!rs.next())
            {
             
  ps=con.prepareStatement("insert into instituteregistration(institutename,institutechief,chiefmobile,instituteaddress,regkey,dateofregistration) values(?,?,?,?,?,?)");

       ps.setString(1, name.getText());
       ps.setString(2,chiefname.getText());
       ps.setString(3,mobNo.getText().trim());
       ps.setString(4,address.getText());
       // ps.setString(4, keycrack.getText());
       ps.setString(5, keycrack1.getText());
       ps.setString(6, datum);

       ps.executeUpdate();
           SmsFile();
       JOptionPane.showConfirmDialog(null,"Congratulations!Welcome to DUCC Family","Registration Complete",JOptionPane.DEFAULT_OPTION);
           System.out.println("new Instikey saved");

           this.dispose();
          // con.close();

            }
           
            rs.first();
        rs.previous();
        if(rs.next())
        {
  ps=con.prepareStatement("update instituteregistration set institutename=?,institutechief=?,chiefmobile=?,instituteaddress=?,regkey=?,dateofregistration=? where 1!=0");

       ps.setString(1, name.getText());
       ps.setString(2,chiefname.getText());
         ps.setString(3,mobNo.getText().trim());
       ps.setString(4,address.getText());
        // ps.setString(4, keycrack.getText());
          ps.setString(5, keycrack1.getText());
       ps.setString(6, datum);
ps.executeUpdate();
JOptionPane.showConfirmDialog(null,"Congratulations!Welcome to DUCC Family","Registration Complete",JOptionPane.DEFAULT_OPTION);

//SmsFile();
System.out.println("Instikey updated");
      //con.close();
 this.dispose();
        }

        }catch(Exception e)
        {
e.printStackTrace();
        }
        }
        else
            JOptionPane.showConfirmDialog(null,"entered key wrong","Wrong key",JOptionPane.DEFAULT_OPTION);

    }
    public void SmsFile()
{
      String id=mobNo.getText().trim();
      //String inputLine;
      String k ="Response";
      String msg="Welcome!Software%20Registratio%20Completed"+"Key="+keycrack1.getText().trim();
      if(mobNo.getText().isEmpty())
      {
          JOptionPane.showConfirmDialog(null,"Mobile no. Field is empty","Mobile Empty",JOptionPane.OK_OPTION);
      } 
      //else
      //new com.duc.Accessories.SendSms().SmsCommon(id,msg);
     }
    //int crow=jTable1.getSelectedRow();
    //String msg=jTextArea1.getText();
    //if(jCheckBox1.isSelected())
      //  id=jTextField2.getText().trim();
    //else
      //   id=dm.getValueAt(crow,8).toString().trim();
      /*  try
        {
        URL yahoo = new URL("http://www.abulksms.com/pushsms.php?username=ravis&password=921695&sender=DUCC%20Sys&cdmasender=mycdmasenderid&to="+id+"&message="+msg);
        URLConnection yc = yahoo.openConnection();
        BufferedReader in = new BufferedReader(
                                new InputStreamReader(
                                yc.getInputStream()));
//InputStream r=yc.getInputStream();


        while ((inputLine = in.readLine()) != null)
        {
            System.out.println(inputLine);
            k=k.concat(inputLine);
        }
             JOptionPane.showConfirmDialog(null,k,"SMS Sender",JOptionPane.PLAIN_MESSAGE);
        in.close();
        }catch(Exception e)
        {
            e.printStackTrace();
        }*/

//}


    /**
    * @param args the command line arguments
    */
    public static void man() {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new InstituteRegistration().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField address;
    private javax.swing.JButton browsepicturebutton;
    private javax.swing.JTextField browsepicturepath;
    private javax.swing.JTextField chiefname;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JCheckBox jCheckBox1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTextPane jTextPane1;
    private javax.swing.JTextPane jTextPane2;
    private org.jdesktop.swingx.JXImagePanel jXImagePanel1;
    private javax.swing.JTextField keycrack;
    private javax.swing.JTextField keycrack1;
    private javax.swing.JTextField mobNo;
    private javax.swing.JTextField name;
    // End of variables declaration//GEN-END:variables
//private Connection con;
    private  PreparedStatement ps;
    ResultSet rs;
    BufferedImage imgpic=null;
private JFileChooser chooser;
String filepath=null;
}
